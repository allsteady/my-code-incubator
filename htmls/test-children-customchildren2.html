<!DOCTYPE html>
<html>
	<head>
		<script src="../libs/jquery-1.8.2.js"></script>
		<script src="../libs/jquery.native.selector.js"></script>
		<style>
			.box {
				display:inline-block;
				width: 9.999%;
				height :30px;
				padding: 10px;
			}
			.box2 {
				border-width: 2px;
				border-style:solid
			}
			table {
				font-family : Arial,Liberation Sans,DejaVu Sans,sans-serif;
				font-size: 15px;
				vertical-align :baseline;
			}
			table .test-content {
				font-size: 12px;
			}
		</style>
		<script>
			var matchesSelectors = ["matchesSelector", "mozMatchesSelector", "webkitMatchesSelector", "oMatchesSelector", "msMatchesSelector" ];
			var matchesSelector;
			var index = 0;
			var tElem = $("html").get( 0 );
			for ( ;index < matchesSelectors.length ; index++ ) {
				if ( tElem[ matchesSelectors[index] ]) {
					window.matchesSelector = matchesSelectors[index];
					break;
				}
			}

			$.fn.scoreIs = function ( selector ) {
				var idx = 0;
				for ( idx; idx < this.length ; idx++ ) {
					if ( this[ idx ][ matchesSelector ]( selector ) ) {
						return true;
					}
				}
				return false;
			};

			$.fn.scoreChildren = function( selector ) {
				var children = this.get ?  this[0].children :  this.childNodes,
					idx = 0, temp = [];

				if ( selector ) {
					for ( ; idx < children.length ; idx++ ) {
						if ( children[idx][ window.matchesSelector ] ( selector ) ) {
							temp.push ( children[idx] );
						}
					}
					children = temp;
				}
				return $.fn.toObject( children );
			};
			
			$.scoreChildren2 = function (context, selector, domResult) {
				context = context.get ? context.get(0) : context;
				var nodes = $.findBySelector(context, selector, true),
					nodesArray = slice.call(nodes),
					result = nodesArray.filter(function (node) {
						return node.parentNode === context;
					});
				return !domResult &&  $.fn.toObject( result ) || result;
			};
			$.fn.toObject = function ( elems ) {
				var idx = 0;
				ret = this.constructor();
				for ( ; idx <elems.length ; idx++ ) {
					ret[idx] = elems [idx];
				}
				ret.length = elems.length;
				return ret;
			};
			
		</script>
		<script>
			var testCases = [];
			
			runTest = function ( ) {
				var idx = 0,
					results = [];
				if ( testCases.length === 0 ) {
					console.log("At least require one test case.");
					return ;
				}

				for ( ; idx <  testCases.length ; idx++ ) {
					results.push ( testExecutor( testCases[idx] ) );
				}
				return results;
			}

			add = function ( tfunc ) {
				if ( typeof(tfunc) ==  "function" ) {
					testCases.push( tfunc );
				}
			}

			displayResult = function ( resultSet ) {
				var $table = $(".test-report"),
					idx = 0,
					htmlStr = "",
					subStr = "";

				for ( ; idx <  resultSet.length ; idx++ ) {
					subStr = "<tr class='test-result-item'> <td> Test" + (idx + 1) + "</td>";
					subStr += "<td class='test-content'> " + (resultSet[idx].content) + "</td>";
					subStr += "<td class='test-return'> " + (resultSet[idx].length) + "</td>";
					subStr += "<td class='test-duration'> " + (resultSet[idx].duration) + "&nbsp;ms.</td></tr>";
					htmlStr += subStr;
				}
				htmlStr +="<tr style='height:15px;'><td></td><td></td><td></td></tr>";
				$table.append($(htmlStr) );
			}
				
			testExecutor = function ( tfunc, count ) {
					if ( !tfunc ) {
						return -1;
					}
					var result = {
							code : 0,
							ret : null,
							length : 0,
							testCount : 0,
							content : "",
							duration : 0
					}, idx = 0, tCount = count || 10000;
						startTime = 0;
					
					result.ret = tfunc();
					result.length = result.ret.length;
					result.testCount = tCount;
					result.content = tfunc.toString();
					startTime = $.now();
					for ( ; idx < tCount ; idx++ ) {
						tfunc();
					} 
					result.duration = $.now() - startTime;
					return result;
				}

			test1 = function () {
				return $(".container-lv1").children(".target");
			}
			test2 = function () {
				return $.childrenBySelector( $(".container-lv1"), ".target");
			}
			test3 = function () {
				return $(".container-lv1").scoreChildren(".target");
			}
			test4 = function () {
				return $.childrenBySelector( $(".container-lv1"), ".target");
			}
			test5 = function () {
				return $.childrenByClass( $(".container-lv1"), "target");
			}
			add( test1 );
			add( test2 );
			add( test3 );
			add( test4 );
			add( test5 );


		</script>
		<title> is v.s custom-is </title>
	</head>
	<body>
		
		<div style="width: 90%;height: 500px; overflow: auto;" class="box box2">
			<button id="runTest"> start</button>
			<button id="removeTest"> clear</button>
			<table style="width:100%" class="test-report">
				<tr style="height: 30px;">
					<td>Test Name</td>
					<td>Function</td>
					<td>Return</td>
					<td>Duration&nbsp;(ms)</td>
				</tr>
			</table>
		</div>
		<script>
				$("#runTest").bind("click", function ( event ) {
					var result = runTest();
					displayResult( result );
				});
				$("#removeTest").bind("click", function ( event ) {
					$(".test-result-item").remove();
				});
		</script>
		<div class='container-lv1'>
			<div class='container-lv2'>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2 target3" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2 target4" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2 target" name='a' ></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2 target2" name='a' ></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
				<div class="box box2" name='a'></div>
			</div>
			<div class='container-lv2 '></div>
			<div class='container-lv2 target'></div>
			<div class='container-lv2'></div>
		</div>
		<!-- container - Lv 1-->
	</body>
	<script>
		var slice = Array.prototype.slice,
        hasClass = (function () {
            if (document.body.classList) {
                return function (node, className) {
                    return node.classList.contains(className);
                };
            }
            return function (node, className) {
                var cls = " " + node.className + " ";
                return cls.indexOf(" " + className + " ") > -1;
            }
        })();
    
    var childrenByClass2 = function(context, className) {
        context = context.get ? context.get(0) : context;
        var nodes = context.children,
            nodesArray = slice.call(nodes),
            result = nodesArray.filter(function(node) {
                return hasClass(node, className);
            });
        return $( result );
    };
    
    var childrenByClass3 = function(context, className) {
        context = context.get ? context.get(0) : context;
        var nodes = context.children,
            nodesArray = slice.call(nodes),
            result = nodesArray.filter(function(node) {
                return hasClass(node, className);
            });
        return $( result );
    };
    
    var c = $('.container-lv1'),
        c2 = c.get(0);
	</script>
</html>